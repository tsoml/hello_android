
<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>Android для тебя </title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

	
	<style type="text/css">
  
  
   #footer {
    position: bot; /* Фиксированное положение */
    left: 0; bottom: 0; /* Левый нижний угол */
    padding: 0px; /* Поля вокруг текста */
	height: 50px;
    background: #39b54a; /* Цвет фона */
    color: #fff; /* Цвет текста */
    width: 100%; /* Ширина слоя */
   }
  </style>
   
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Android для тебя :)</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="main.html">Главная</a></li>
            <li><a href="info.html">О Проекте</a></li>
            <li><a href="contacts.html">Контакты</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

	
	<br>
	
	
	
	</br>
	
	<br>
	
	
	
    <div class="container">

      <div class="starter-template">
			<h1 class="text-warning">Урок 3. Щелчок кнопки/Счётчик ворон</h1>


			<p>На предыдущем занятии мы немного поработали с кнопкой. Сегодня рассмотрим работу с обработкой щелчков подробнее.</p>

			<p>Можете использовать старый проект или создать новый проект с стандартными настройками.</p>

			<p>В прошлый раз мы использовали <b>ImageButton</b>. Сегодня будем работать с обычной кнопкой. В режиме <b>Design</b> подведите курсор к элементу <b>Button</b> и перетащите его на форму. В результате ваших действий на форме появится стандартная кнопка с настройками по умолчанию. В правой части экрана у вас имеется окно <b>Properties</b>, в котором вы можете настроить необходимые свойства для кнопки. По своей старой привычке я присвоил свойству <b>id</b> новое значение <b>buttonHello</b> вместо стандартного <b>button</b>. Если временно переключиться в режим <b>Text</b>, то увидите, что на самом деле атрибут имеет значение <b>@+id/buttonHello</b>. Студия немного экономит время для установки идентификаторов, а в Eclipse приходилось писать значение полностью. Естественно, если вы редактируете свойства в текстовом виде, то вам тоже надо придерживаться этого стандарта. Свойству <b>Text</b> присвойте текст <b>Поздороваться</b>. Будет отлично, если вы добавите этот текст через ресурсы. В учебных примерах я буду использовать текст прямо в свойствах для экономии места, но вы должны привыкать писать код правильно.</p>

			<p>Если вы открыли предыдущий проект, то там уже был компонент <b>TextView</b> с текстом <b>Hello, World</b> (если вы создали новый проект). Компонент <b>TextView</b> является текстовой меткой для вывода текста, который нельзя редактировать. В метке будем выводить приветствие после щелчка кнопки. В окне свойств удаляем текст из свойства <b>Text</b>, чтобы в текстовой метке ничего не было. Проследите, чтобы у него был идентификатор. Если в окне свойств ничего нет, то добавьте свой идентификатор, например, <b>textView</b> (<b>@+id/textView</b>).</p>

			<p>Если вам не нравится взаимное расположение элементов, то можете на форме перетаскивать элементы, меняя их местами.</p>

			<p>Будем считать, что интерфейс программы готов - у нас есть кнопка для нажатия и текстовая метка для вывода сообщений.</p>

			<p>Теперь нужно научиться писать код для щелчка кнопки. Переключитесь с режима <b>Design</b> на режим <b>Text</b> и найдите тег <b>&lt;Button&gt;</b>. Добавьте к нему еще одну строчку:</p>

			<pre><code class="xml">
			&lt;Button
				android:id=&quot;@+id/buttonHello&quot;
				android:layout_width=&quot;wrap_content&quot;
				android:layout_height=&quot;wrap_content&quot;
				android:layout_alignParentLeft=&quot;true&quot;
				android:layout_alignParentTop=&quot;true&quot;
				<b class="text-success">android:onClick=&quot;onClick&quot;</b>
				android:text=&quot;Поздороваться&quot; /&gt;
			</code></pre>

			<p>На самом деле это можно было сделать и через графическую модель. Переключитесь обратно в режим <b>Design</b> и найдите в свойствах кнопки пункт <b>OnСlick</b>. Там будет прописано имя метода, которое мы задали через XML. Пользуйтесь любым удобным вам способом.</p>

			<p>Таким образом мы определили событие <b>onClick</b> для кнопки (щелчок) и теперь осталось написать обработчик события. Вы уже знаете, как в Android Studio быстро создать заготовку. В текстовом режиме нажимаем комбинацию <b>Alt+Enter</b> и шаблон готов.</p>

			<pre><code>
			public void onClick(View view) {
				
			}
			</code></pre>

			<p>Вставим код.</p>

			<pre><code class="java">
			public void onClick(View view){
				TextView helloTextView = (TextView)findViewById(R.id.textView);
				helloTextView.setText("Hello Kitty!");
			}
			</code></pre>

			<p>Впрочем, это код нам уже знаком по предыдущему занятию. Есть небольшое отличие. Текстовую метку мы объявляем и присваиваем ссылку на нужный компонент сразу в методе щелчка. Приложение у нас простое и доступ к текстовой метке больше нигде не осуществляется. Поэтому нет нужды объявлять переменную на уровне класса и инициализировать её в методе <b>onCreate()</b>. Если вы набирали текст самостоятельно, то у вас всё получится. Если просто скопировали и получили ошибки, то разбирайтесь сами. Я лентяям не помогаю.</p>

			<p>Раньше в Eclipse метод для щелчка писался вручную, а теперь создаётся автоматически. Радуемся.</p>

			<p>Запускаем проект и нажимаем на кнопку, чтобы увидеть результат. Можете изменить текст по своему желанию, например, на <i>Ты кто такой? Давай, до свидания!</i>, но это сообщение будет выглядеть мягко говоря, странным.</p>

			<p>Полный текст кода будет выглядеть следующим образом.</p>

			<pre><code class="java">
			// Если этот код работает, его написал Александр Климов,
			// а если нет, то не знаю, кто его писал.
			package ru.alexanderklimov.hellokitty;

			import android.app.Activity;
			import android.os.Bundle;
			import android.view.Menu;
			import android.view.MenuItem;
			import android.view.View;
			import android.widget.TextView;

			public class MainActivity extends Activity {

				@Override
				protected void onCreate(Bundle savedInstanceState) {
					super.onCreate(savedInstanceState);
					setContentView(R.layout.activity_main);
				}

				public void onClick(View view){
					TextView helloTextView = (TextView)findViewById(R.id.textView);
					helloTextView.setText("Hello Kitty!");
				}
			}
			</code></pre>

			<p>Ещё раз обратите внимание на строчку <b>TextView helloTextView = (TextView)findViewById(R.id.textView);</b>. В интернете есть популярная забава <a href="http://alexanderklimov.ru/2011/07/28/naidi-kotov/">Найди кота</a>. Метод <b>findViewById()</b> переводится как <b>НайдиКомпонентПоИдентификатору</b> и применяет тот же подход - вы указываете в параметре идентификатор ресурса и программа ищет подходящий компонент. В дальнейшем вы постоянно будете использовать данный код в своих программах.</p>

			<p><img src="images/android3.png" alt="Код для щелчка мыши"></p>

			<p>Новички на первых порах часто делают элементарную ошибку - помещают строчку инициализации объекта до метода <b>setContentView()</b>. Запомните, сначала нужно вывести шаблон (<b>R.layout.activity_main</b>), а только потом кнопки, текстовые поля, переключатели и т.д. В нашем случае используется отдельный метод для кнопки, который формируется после метода <b>setContentView()</b>. Позже, в других проектах вы увидите стандартные приёмы инициализации объектов.</p>

			<h2 class="text-warning">Другой способ обработки щелчка кнопки</h2>

			<p>На самом деле, способ обработки щелчка кнопки, который я вам показал, является относительно новым для разработчиков. Google рекомендует использовать данный способ как удобный, требующий меньше кода и понятный для чтения. Но тем не менее вам придётся сталкиваться со старым способом, который берет свои корни от Java. Поэтому необходимо изучить и второй способ, чтобы понимать другие примеры.</p>

			<p>Добавьте в проект новую кнопку. Если первую кнопку мы добавляли перетаскиванием элемента <b>Button</b> с панели инструментов, то на этот раз мы попробуем создать кнопку вручную. Откройте файл <b>activity_main.xml</b> в режиме редактора кода и скопируйте код для первой кнопки. Потом с новой строки вставьте скопированный текст и подправьте несколько атрибутов, например, так.</p>

			<pre><code class="xml">
			&lt;Button
				android:id=&quot;@+id/buttonCrowsCounter&quot;
				android:layout_width=&quot;wrap_content&quot;
				android:layout_height=&quot;wrap_content&quot;
				android:layout_alignParentLeft=&quot;true&quot;
				android:layout_below=&quot;@+id/buttonHello&quot;
				android:text=&quot;Считаем ворон&quot; /&gt;
			</code></pre>

			<p>Я поменял для кнопки текст и идентификатор, а также некоторые параметры, отвечающие за положение кнопки на экране. Переключитесь в графический режим и посмотрите, как выглядит кнопка. Обратите внимание, что строку типа <b>android:onClick=&quot;buttonCrowsCounter_Click&quot;</b> мы уже не используем. Если вас не устраивает положение кнопки, то перетащите её в другое место.</p>

			<p>Снова открываем файл <b>MainActivity.java</b> и пишем следующий код сразу после объявления класса и до метода <b>onCreate()</b>:</p>

			<pre><code class="java">
			private Button mCrowsCounterButton;
			</code></pre>

			<p>Во время набора студия будет пытаться угадать, что вы хотите ввести. Активно используйте подсказки. Например, уже при первом вводе символа <b>B</b> студия предложит несколько вариантов на эту букву. Если нужное слово находится первым в списке, то нажимайте клавишу Enter, иначе выберите нужное слово из списка и потом уже нажимайте Enter. Это удобно при наборе длинных имён классов и переменных.</p>

			<p>Google разработал целое руководство по наименованию переменных. Например, закрытая переменная на уровне класса должна начинаться с символа <b>m</b> (member), а далее идёт понятное название с заглавной буквы. Давайте попробуем придерживаться этого стиля.</p>

			<p>После строчки <b>setContentView(R.layout.activity_main);</b> пишем:</p>

			<pre><code class="java">
			mCrowsCounterButton = (Button)findViewById(R.id.buttonCrowsCounter);
			</code></pre>

			<p>Ещё раз напоминаю, не копируйте текст со страницы, а вводите текст вручную. Так вы быстрее освоите программирование, кроме того научитесь пользоваться системой подсказок и уменьшите количество опечаток.</p>

			<p>Переходим к самому важному - обработчику щелчка кнопки. Нам понадобится дополнительная переменная-счётчик <b>mCount</b>, которая будет содержать число подсчитанных ворон (её необходимо разместить выше метода <b>onCreate()</b> рядом с переменной <b>mCrowsCounterButton</b>).</p>

			<pre><code class="java">
			private int mCount = 0;
			</code></pre>

			<p>Теперь пишем обработчик, активно используя всплывающие подсказки для быстрого набора. Код добавляется в методе <b>onCreate()</b> после других строк, написанных ранее в этом методе.</p>

			<p>Попробую описать, как использовать автодополнение. Сначала начинаем вводим первые символы слова <b>mCrowsCounterButton</b> (можно маленькими буквами) и нажимаем Enter, если видим, что нужная подсказка появилась. После этого слова ставим точку и должны появиться опять подсказки, которые относятся к данной переменной. Начинаем вводим первые буквы слова <b>setOnClickListener</b>. Здесь тоже проблем обычно не возникает. На данный момент у нас получилась строка <b>mCrowsCounterButton.setOnClickListener();</b>. Ставим курсор внутри круглых скобок и набираем <b>new OnClickListener</b>. Здесь важно набрать символ <b>O</b> в верхнем регистре. Тогда у вас появится нужная подсказка типа <b>OnClickListener{...} (android.view.View)</b>. Нажимаем Enter и получаем нужную заготовку, внутри которой вставляем код:</p>

			<pre><code class="java">
			mCrowsCounterButton.setOnClickListener(new View.OnClickListener() {
				@Override
				public void onClick(View v) {
					mInfoTextView.setText("Я насчитал " + ++mCount + " ворон");
				}
			});
			</code></pre>

			<p>Ранее мы объявили переменную <b>helloTextView</b> внутри метода <b>onClick()</b>, из которого она недоступна  в других методах. Поэтому поступим с ней так же, как с кнопкой - объявим текстовую метку на уровне класса и инициализируем её в методе <b>onCreate()</b>. Сделайте это самостоятельно, создав переменную с именем <b>mInfoTextView</b>.</p>

			<p>Запускаем приложение и начинаем щёлкать по кнопке. При каждом щелчке счётчик <b>mCount</b> будет увеличиваться на единицу и эта информация будет отображаться на экране.</p>

			<p>Нет смысла дублировать код для одной текстовой метки. Поэтому для первой кнопки, которая здоровалась, код можно сократить.</p>

			<pre><code class="java">
			public void onClick(View view) {
				mInfoTextView.setText("Hello Kitty!");
			}
			</code></pre>

			<p>Мы познакомились с новым способом обработки щелчка кнопки. Какой способ вы предпочтёте - зависит от ваших привычек и вкуса. Более того, есть ещё один способ, о котором можно прочитать в отдельной статье о кнопках.</p>

			<p><img src="images/android3-1.png" alt="Счетчик ворон"></p>

			<p>Теперь у вас есть чрезвычайно полезное приложение <b>Счётчик ворон</b>. Если преподаватель вас неожиданно спросит на занятии, почему вы смотрите в окно с рассеяным видом, вы можете смело достать свой телефон и сказать, что заняты очень важным делом - считаете ворон.</p>

			<p><img src="images/crow2.jpg" alt="Считаем ворон"><p>

			<p>Впрочем, программа получилась у нас универсальной, можно считать не только ворон за окном.</p>

			

			<h2 class="text-warning">Исправляем ошибки</h2>

			<p>На первых порах новички делают элементарные ошибки - опечатки, копирование куска кода без его понимания, пишут не в том месте и т.д. Студия пытается по мере возможностей подсказать вам, но не все обращают внимание на предупреждения, а потом пишут письма с просьбой разобраться. Небольшой ликбез по нахождению ошибок. В редакторе кода в верхнем правом углу есть прямоугольник. Он может быть зелёным (идеальный код), жёлтым (не смертельно, но лучше исправить) и красным (ошибка в коде, программа не запустится).</p>

			<p>Ваша задача - стремиться к зелёному цвету. Жёлтый цвет желательно просматривать и решать самостоятельно, нужно ли исправлять код. Если вы понимаете в чём проблема, то исправьте. Если не понятно, то оставьте. Предупреждения не всегда бывают по делу, иногда их можно игнорировать. Понимание придёт с опытом и практикой.</p>

			<p>Ниже показан случай, когда я сделал опечатку в названии класса <b>String</b>.</p>

			<p><img src="images/android3_2.png"></p>

			<p>Помимо прямоугольника, там же ниже есть зарубки с такими же цветами. Подведите курсор мыши к любой из зарубок и увидите подсказку о характере ошибки или предупреждения. Щелчок по зарубке перенесёт вас в нужное место в документе.</p>
      </div>

    </div><!-- /.container -->

	
	
	<br>
	
	 <!-- Site footer -->
      <div id="footer">
	  <br>
	  <center>
        <p>&copy; Alexander Kazmin 2016</p>
		</center>
      </div>
	
	
	
	
	

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>